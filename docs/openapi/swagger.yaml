definitions:
  handler.ErrorResponse:
    properties:
      error:
        type: string
    type: object
  handler.PositionRequest:
    properties:
      position:
        minimum: 0
        type: integer
    required:
    - position
    type: object
  handler.SuccessResponse:
    properties:
      message:
        type: string
    type: object
  handler.UpdateMemberRoleRequest:
    properties:
      role:
        enum:
        - admin
        - moderator
        - member
        type: string
    required:
    - role
    type: object
  model.Channel:
    properties:
      created_at:
        type: string
      guild:
        $ref: '#/definitions/model.Guild'
      guild_id:
        type: integer
      id:
        type: integer
      name:
        type: string
      position:
        type: integer
      topic:
        type: string
      type:
        description: text, voice
        type: string
      updated_at:
        type: string
    type: object
  model.Guild:
    properties:
      created_at:
        type: string
      description:
        type: string
      icon:
        type: string
      id:
        type: integer
      name:
        type: string
      owner:
        $ref: '#/definitions/model.User'
      owner_id:
        type: integer
      updated_at:
        type: string
    type: object
  model.GuildMember:
    properties:
      created_at:
        type: string
      guild:
        $ref: '#/definitions/model.Guild'
      guild_id:
        type: integer
      id:
        type: integer
      joined_at:
        type: string
      nickname:
        type: string
      role:
        description: owner, admin, member
        type: string
      updated_at:
        type: string
      user:
        $ref: '#/definitions/model.User'
      user_id:
        type: integer
    type: object
  model.Message:
    properties:
      channel:
        $ref: '#/definitions/model.Channel'
      channel_id:
        type: integer
      content:
        type: string
      created_at:
        type: string
      id:
        type: integer
      type:
        description: text, image, file
        type: string
      updated_at:
        type: string
      user:
        $ref: '#/definitions/model.User'
      user_id:
        type: integer
    type: object
  model.User:
    properties:
      avatar:
        type: string
      created_at:
        type: string
      email:
        type: string
      id:
        type: integer
      nickname:
        type: string
      status:
        description: online, offline, busy, away
        type: string
      updated_at:
        type: string
      username:
        type: string
    type: object
  service.CreateChannelRequest:
    properties:
      guild_id:
        type: integer
      name:
        maxLength: 100
        minLength: 1
        type: string
      position:
        type: integer
      topic:
        maxLength: 1024
        type: string
      type:
        enum:
        - text
        - voice
        type: string
    required:
    - guild_id
    - name
    - type
    type: object
  service.CreateGuildRequest:
    properties:
      description:
        maxLength: 500
        type: string
      icon:
        maxLength: 256
        type: string
      name:
        maxLength: 100
        minLength: 2
        type: string
    required:
    - name
    type: object
  service.CreateMessageRequest:
    properties:
      channel_id:
        type: integer
      content:
        type: string
      type:
        description: 'text, image, file (預設: text)'
        type: string
    required:
    - channel_id
    - content
    type: object
  service.LoginRequest:
    properties:
      email:
        type: string
      password:
        type: string
    required:
    - email
    - password
    type: object
  service.LoginResponse:
    properties:
      token:
        type: string
      user:
        $ref: '#/definitions/model.User'
    type: object
  service.MessageListResponse:
    properties:
      messages:
        items:
          $ref: '#/definitions/model.Message'
        type: array
      page:
        type: integer
      page_size:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  service.RegisterRequest:
    properties:
      email:
        type: string
      nickname:
        maxLength: 64
        type: string
      password:
        maxLength: 128
        minLength: 6
        type: string
      username:
        maxLength: 32
        minLength: 3
        type: string
    required:
    - email
    - password
    - username
    type: object
  service.UpdateChannelRequest:
    properties:
      name:
        maxLength: 100
        minLength: 1
        type: string
      position:
        type: integer
      topic:
        maxLength: 1024
        type: string
      type:
        enum:
        - text
        - voice
        type: string
    type: object
  service.UpdateGuildRequest:
    properties:
      description:
        maxLength: 500
        type: string
      icon:
        maxLength: 256
        type: string
      name:
        maxLength: 100
        minLength: 2
        type: string
    type: object
  service.UpdateMessageRequest:
    properties:
      content:
        type: string
    required:
    - content
    type: object
  service.UpdateUserRequest:
    properties:
      avatar:
        maxLength: 256
        type: string
      nickname:
        maxLength: 64
        type: string
      status:
        enum:
        - online
        - offline
        - busy
        - away
        type: string
    type: object
info:
  contact:
    email: support@talkrealm.example.com
    name: API Support
    url: http://www.talkrealm.example.com/support
  description: TalkRealm 是一個即時通訊平台，類似 Discord，提供文字和語音聊天功能。
  termsOfService: http://talkrealm.example.com/terms/
  title: TalkRealm API
  version: "1.0"
paths:
  /api/auth/login:
    post:
      consumes:
      - application/json
      parameters:
      - description: 登入資訊
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/service.LoginResponse'
      summary: 使用者登入
      tags:
      - auth
  /api/auth/register:
    post:
      consumes:
      - application/json
      parameters:
      - description: 註冊資訊
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/model.User'
      summary: 使用者註冊
      tags:
      - auth
  /api/users/me:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.User'
      security:
      - BearerAuth: []
      summary: 取得當前使用者資訊
      tags:
      - users
    patch:
      consumes:
      - application/json
      parameters:
      - description: 更新資訊
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.UpdateUserRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.User'
      security:
      - BearerAuth: []
      summary: 更新當前使用者資訊
      tags:
      - users
  /api/v1/channels:
    get:
      consumes:
      - application/json
      description: 列出指定社群的所有頻道
      parameters:
      - description: 社群 ID
        in: query
        name: guild_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/model.Channel'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 列出社群的頻道
      tags:
      - Channel
    post:
      consumes:
      - application/json
      description: 在社群中建立新的文字或語音頻道（僅擁有者或管理員）
      parameters:
      - description: 建立頻道請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.CreateChannelRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/model.Channel'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 建立頻道
      tags:
      - Channel
  /api/v1/channels/{id}:
    delete:
      consumes:
      - application/json
      description: 刪除頻道（僅擁有者或管理員）
      parameters:
      - description: 頻道 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 刪除頻道
      tags:
      - Channel
    get:
      consumes:
      - application/json
      description: 取得指定頻道的詳細資訊
      parameters:
      - description: 頻道 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.Channel'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 取得頻道詳情
      tags:
      - Channel
    put:
      consumes:
      - application/json
      description: 更新頻道資訊（僅擁有者或管理員）
      parameters:
      - description: 頻道 ID
        in: path
        name: id
        required: true
        type: integer
      - description: 更新頻道請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.UpdateChannelRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.Channel'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 更新頻道
      tags:
      - Channel
  /api/v1/channels/{id}/position:
    put:
      consumes:
      - application/json
      description: 更新頻道在列表中的位置（僅擁有者或管理員）
      parameters:
      - description: 頻道 ID
        in: path
        name: id
        required: true
        type: integer
      - description: 位置請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.PositionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 更新頻道位置
      tags:
      - Channel
  /api/v1/guilds:
    get:
      consumes:
      - application/json
      description: 列出當前使用者所屬的所有社群
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/model.Guild'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 列出使用者的社群
      tags:
      - Guild
    post:
      consumes:
      - application/json
      description: 建立一個新的社群，建立者自動成為擁有者
      parameters:
      - description: 建立社群請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.CreateGuildRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/model.Guild'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 建立社群
      tags:
      - Guild
  /api/v1/guilds/{id}:
    delete:
      consumes:
      - application/json
      description: 刪除社群（僅擁有者）
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 刪除社群
      tags:
      - Guild
    get:
      consumes:
      - application/json
      description: 取得指定社群的詳細資訊
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.Guild'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 取得社群詳情
      tags:
      - Guild
    put:
      consumes:
      - application/json
      description: 更新社群資訊（僅擁有者）
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      - description: 更新社群請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.UpdateGuildRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.Guild'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 更新社群
      tags:
      - Guild
  /api/v1/guilds/{id}/join:
    post:
      consumes:
      - application/json
      description: 使用者加入指定社群
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 加入社群
      tags:
      - GuildMember
  /api/v1/guilds/{id}/leave:
    post:
      consumes:
      - application/json
      description: 使用者離開社群（擁有者需先轉移所有權）
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 離開社群
      tags:
      - GuildMember
  /api/v1/guilds/{id}/members:
    get:
      consumes:
      - application/json
      description: 列出社群的所有成員
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/model.GuildMember'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 列出社群成員
      tags:
      - GuildMember
  /api/v1/guilds/{id}/members/{userId}:
    delete:
      consumes:
      - application/json
      description: 擁有者踢出社群成員
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      - description: 使用者 ID
        in: path
        name: userId
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 踢出成員
      tags:
      - GuildMember
  /api/v1/guilds/{id}/members/{userId}/role:
    put:
      consumes:
      - application/json
      description: 擁有者更新成員角色
      parameters:
      - description: 社群 ID
        in: path
        name: id
        required: true
        type: integer
      - description: 使用者 ID
        in: path
        name: userId
        required: true
        type: integer
      - description: 更新角色請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateMemberRoleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handler.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/handler.ErrorResponse'
      summary: 更新成員角色
      tags:
      - GuildMember
  /api/v1/messages:
    get:
      description: 列出指定頻道的所有訊息（分頁）
      parameters:
      - description: 頻道 ID
        in: query
        name: channel_id
        required: true
        type: integer
      - default: 1
        description: 頁碼
        in: query
        name: page
        type: integer
      - default: 50
        description: 每頁數量
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/service.MessageListResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 列出頻道訊息
      tags:
      - messages
    post:
      consumes:
      - application/json
      description: 在指定頻道中建立新訊息
      parameters:
      - description: 建立訊息請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.CreateMessageRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/model.Message'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 建立訊息
      tags:
      - messages
  /api/v1/messages/{id}:
    delete:
      description: 刪除自己的訊息，或管理員刪除任何訊息
      parameters:
      - description: 訊息 ID
        in: path
        name: id
        required: true
        type: integer
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 刪除訊息
      tags:
      - messages
    get:
      description: 取得指定 ID 的訊息詳情
      parameters:
      - description: 訊息 ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.Message'
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 取得訊息
      tags:
      - messages
    put:
      consumes:
      - application/json
      description: 更新自己發送的訊息內容
      parameters:
      - description: 訊息 ID
        in: path
        name: id
        required: true
        type: integer
      - description: 更新訊息請求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/service.UpdateMessageRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.Message'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 更新訊息
      tags:
      - messages
swagger: "2.0"
